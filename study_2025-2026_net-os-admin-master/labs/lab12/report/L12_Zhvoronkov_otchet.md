```markdown
# РОССИЙСКИЙ УНИВЕРСИТЕТ ДРУЖБЫ НАРОДОВ

**Факультет физико-математических и естественных наук**

**Кафедра теории вероятностей и кибербезопасности**

**ОТЧЁТ**

**ПО ЛАБОРАТОРНОЙ РАБОТЕ №12**

_<u>дисциплина: Администрирование сетевых подсистем</u>_

> <u>Студент: Жаворонков Кирилл Александрович</u>
>
> Студ. билет № 1132231844
>
> Группа: НПИбд-01-23

**МОСКВА**

2025 г.

## Цель работы:

Целью данной работы является получение навыков по управлению системным временем и настройке синхронизации времени.

## Выполнение работы:

На сервере (Рис. 1.1) и клиенте (Рис. 1.2) посмотрим параметры настройки даты и времени, текущего системного времени и аппаратного времени:
```

timedatectl
date
hwclock

```

![Рис. 1.1. Просмотр на сервере параметров настройки даты и времени, текущего системного времени и аппаратного времени.](media/image1.png)

![Рис. 1.2. Просмотр на клиенте параметров настройки даты и времени, текущего системного времени и аппаратного времени.](media/image2.png)

Установим на сервере необходимое программное обеспечение (Рис. 2.1):

```

dnf -y install chrony

```

![Рис. 2.1. Установка на сервере программного обеспечения chrony.](media/image3.png)

Проверим источники времени на клиенте (Рис. 2.2) и на сервере (Рис. 2.3):

```

chronyc sources

```

![Рис. 2.2. Проверка источника времени на клиенте.](media/image4.png)

![Рис. 2.3. Проверка источника времени на сервере.](media/image5.png)

На сервере откроем на редактирование файл /etc/chrony.conf и добавим строку (Рис. 2.4):

```

allow 192.168.0.0/16

```

![Рис. 2.4. Открытие на сервере файла /etc/chrony.conf на редактирование и добавление строки.](media/image6.png)

На сервере перезапустим службу chronyd:

```

systemctl restart chronyd

```

И настроим межсетевой экран на сервере (Рис. 2.5):

```

firewall-cmd --add-service=ntp --permanent
firewall-cmd --reload

```

![Рис. 2.5. Перезапуск на сервере службы chronyd и настройка межсетевого экрана.](media/image7.png)

На клиенте откроем файл /etc/chrony.conf и добавим строку:

```

server server.kazhavoronkov.net iburst

```

После чего удалим все остальные строки с директивой server (Рис. 2.6):

![Рис. 2.6. Открытие на клиенте файла /etc/chrony.conf и добавление строки. Удаление всех остальных строк с директивой server.](media/image8.png)

На клиенте перезапустим службу chronyd (Рис. 2.7):

```

systemctl restart chronyd

```

![Рис. 2.7. Перезапуск на клиенте службы chronyd.](media/image9.png)

Проверим источники времени на клиенте (Рис. 2.8) и на сервере (Рис. 2.9):

```

chronyc sources

```

![Рис. 2.8. Проверка источника времени на клиенте.](media/image10.png)

![Рис. 2.9. Проверка источника времени на сервере.](media/image11.png)

На виртуальной машине server перейдём в каталог для внесения изменений в настройки внутреннего окружения /vagrant/provision/server/, создадим в нём каталог ntp, в который поместим в соответствующие подкаталоги конфигурационные файлы. В каталоге /vagrant/provision/server создадим исполняемый файл ntp.sh (Рис. 3.1):

![Рис. 3.1. Переход на виртуальной машине server в каталог для внесения изменений в настройки внутреннего окружения /vagrant/provision/server/, создание в нём каталога ntp, в который помещаем в соответствующие подкаталоги конфигурационные файлы. Создание в каталоге /vagrant/provision/server исполняемого файла ntp.sh.](media/image12.png)

Открыв его на редактирование, пропишем в нём следующий скрипт из лабораторной работы (Рис. 3.2):

![Рис. 3.2. Открытие файла на редактирование и добавление скрипта.](media/image13.png)

На виртуальной машине client перейдём в каталог для внесения изменений в настройки внутреннего окружения /vagrant/provision/client/, создадим в нём каталог ntp, в который поместим в соответствующие подкаталоги конфигурационные файлы. В каталоге /vagrant/provision/client создадим исполняемый файл ntp.sh (Рис. 3.3):

![Рис. 3.3. Переход на виртуальной машине client в каталог для внесения изменений в настройки внутреннего окружения /vagrant/provision/client/, создание в нём каталога ntp, в который помещаем в соответствующие подкаталоги конфигурационные файлы. Создание в каталоге /vagrant/provision/client исполняемого файла ntp.sh.](media/image14.png)

Открыв его на редактирование, пропишем в нём следующий скрипт из лабораторной работы (Рис. 3.4):

![Рис. 3.4. Открытие файла на редактирование и добавление скрипта.](media/image15.png)

Для отработки созданных скриптов во время загрузки виртуальных машин server и client в конфигурационном файле Vagrantfile добавим в соответствующих разделах конфигураций для сервера (Рис. 3.5) и клиента (Рис. 3.6):

![Рис. 3.5. Добавление записи в конфигурационном файле Vagrantfile для сервера.](media/image16.png)

![Рис. 3.6. Добавление записи в конфигурационном файле Vagrantfile для клиента.](media/image17.png)

## Вывод:

В ходе выполнения лабораторной работы были получены навыки по управлению системным временем и настройке синхронизации времени.

## Ответы на контрольные вопросы:

1.  **Почему важна точная синхронизация времени для служб баз данных?**
    Синхронизация времени необходима для обеспечения корректности временных меток в базе данных. Распределенные системы баз данных чувствительны к разнице во времени между узлами, и несогласованность времени может привести к проблемам с транзакциями и целостью данных.

2.  **Почему служба проверки подлинности Kerberos сильно зависит от правильной синхронизации времени?**
    Kerberos использует временные метки для предотвращения атак воспроизведения билетов. Если время не синхронизировано, билеты могут быть считаны как недействительные, что приведет к проблемам с аутентификацией.

3.  **Какая служба используется по умолчанию для синхронизации времени на RHEL 7?**
    На RHEL 7 служба синхронизации времени по умолчанию - chrony.

4.  **Какова страта по умолчанию для локальных часов?**
    Страта 0 (нулевая) - локальные часы, являющиеся источником времени.

5.  **Какой порт брандмауэра должен быть открыт, если вы настраиваете свой сервер как одноранговый узел NTP?**
    Порт 123 (UDP) должен быть открыт для протокола NTP.

6.  **Какую строку вам нужно включить в конфигурационный файл chrony, если вы хотите быть сервером времени, даже если внешние серверы NTP недоступны?**
    В конфигурационном файле /etc/chrony.conf добавьте строку:
    `local stratum 10`

7.  **Какую страту имеет хост, если нет текущей синхронизации времени NTP?**
    Страта 16 - хост без синхронизации времени NTP.

8.  **Какую команду вы бы использовали на сервере с chrony, чтобы узнать, с какими серверами он синхронизируется?**
    `chronyc sources -v`

9.  **Как вы можете получить подробную статистику текущих настроек времени для процесса chrony вашего сервера?**
    `chronyc tracking`
    Эта команда предоставляет подробную информацию о текущей синхронизации времени, дисперсии, коррекции часов и других параметрах.
```
